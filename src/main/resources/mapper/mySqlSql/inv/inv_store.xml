<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatiio.org//DTD Mapper 3.0//EN"
        "http://mybatiio.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="inv_store">

    <select id="getStoreListByPageCount" resultType="int" parameterType="Map">
        SELECT count(1) FROM inv_bill_header
        where 1=1
        <if test="bill_type != null and bill_type!=''">  and bill_type=#{bill_type} </if>
    </select>

    <select id="getStoreListByPage" resultType="Map" parameterType="Map">
        SELECT ibh.*,fo.org_name as `inv_org_name` FROM inv_bill_header ibh LEFT JOIN fnd_org fo on inv_org_id = org_id
        where 1=1
        <if test="bill_type != null and bill_type!=''">  and bill_type=#{bill_type} </if>
        ORDER BY create_date desc
        limit #{startIndex},#{perPage}
    </select>

    <select id="getStoreById" resultType="Map" parameterType="Map">
        SELECT ibh.*,fo.org_name as `inv_org_name` FROM inv_bill_header ibh LEFT JOIN fnd_org fo on inv_org_id = org_id
        where bill_id=#{bill_id}
    </select>

    <insert id="createStore"  parameterType="Map" keyColumn="bill_id" keyProperty="bill_id" useGeneratedKeys="true">
        INSERT INTO inv_bill_header( `bill_type`, `inv_org_id`, `target_inv_org_id`, `bill_date`, `remark`, `create_by`, `bill_status`, `source_system`, `source_bill`, `source_id`)
        VALUES (#{bill_type}, #{inv_org_id}, #{target_inv_org_id}, #{bill_date}, #{remark}, #{create_by}, #{bill_status}, #{source_system}, #{source_bill}, #{source_id});
    </insert>

</mapper>
