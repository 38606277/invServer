<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mdmItem">

	<!--  创建func_dict信息  -->
	<insert id="createMdmItem" parameterType="Map" useGeneratedKeys="true" keyProperty="id">
		insert into mdm_item(item_id,item_category_id,item_description,segment1,segment2,segment3,segment4,segment5,segment6,segment7,segment8,segment9,segment10,attribute1,attribute2)
		values (#{item_id},'${item_category_id}','${item_description}',
		<if  test="segment1 == null">NULL</if> <if  test="segment1 != null">#{segment1}</if>,
		<if  test="segment2 == null">NULL</if> <if  test="segment2 != null">#{segment2}</if>,
		<if  test="segment3 == null">NULL</if> <if  test="segment3 != null">#{segment3}</if>,
		<if  test="segment4 == null">NULL</if> <if  test="segment4 != null">#{segment4}</if>,
		<if  test="segment5 == null">NULL</if> <if  test="segment5 != null">#{segment5}</if>,
		<if  test="segment6 == null">NULL</if> <if  test="segment6 != null">#{segment6}</if>,
		<if  test="segment7 == null">NULL</if> <if  test="segment7 != null">#{segment7}</if>,
		<if  test="segment8 == null">NULL</if> <if  test="segment8 != null">#{segment8}</if>,
		<if  test="segment9 == null">NULL</if> <if  test="segment9 != null">#{segment9}</if>,
		<if  test="segment10 == null">NULL</if> <if  test="segment10 != null">#{segment10}</if>,
		<if  test="attribute1 == null">NULL</if> <if  test="attribute1 != null">#{attribute1}</if>,
		<if  test="attribute2 == null">NULL</if> <if  test="attribute2 != null">#{attribute2}</if>
		)
	</insert>

	<!-- 修改 func_dict 表的信息 -->
	<update id="updateMdmItem" parameterType="Map">
		update mdm_item set
		<if  test="segment1 == null">segment1=NULL</if>
		<if  test="segment1 != null">segment1=#{segment1}</if>,
		<if  test="segment2 == null">segment2=NULL</if>
		<if  test="segment2 != null">segment2=#{segment2}</if>,
		<if  test="segment3 == null">segment3=NULL</if>
		<if  test="segment3 != null">segment3=#{segment3}</if>,
		<if  test="segment4 == null">segment4=NULL</if>
		<if  test="segment4 != null">segment4=#{segment4}</if>,
		<if  test="segment5 == null">segment5=NULL</if>
		<if  test="segment5 != null">segment5=#{segment5}</if>,
		<if  test="segment6 == null">segment6=NULL</if>
		<if  test="segment6 != null">segment6=#{segment6}</if>,
		<if  test="segment7 == null">segment7=NULL</if>
		<if  test="segment7 != null">segment7=#{segment7}</if>,
		<if  test="segment8 == null">segment8=NULL</if>
		<if  test="segment8 != null">segment8=#{segment8}</if>,
		<if  test="segment9 == null">segment9=NULL</if>
		<if  test="segment9 != null">segment9=#{segment9}</if>,
		<if  test="segment10 == null">segment10=NULL</if>
		<if  test="segment10 != null">segment10=#{segment10}</if>,
		<if  test="attribute1 == null">attribute1=NULL</if>
		<if  test="attribute1 != null">attribute1=#{attribute1}</if>,
		<if  test="attribute2 == null">attribute2=NULL</if>
		<if  test="attribute2 != null">attribute2=#{attribute2}</if>
		 where item_id=#{item_id}
	</update>

	<select id="getMaxId" resultType="java.lang.Integer" >
        SELECT (MAX(item_id) +1)as item_id from mdm_item
    </select>

	<select id="getItemByCategoryId" parameterType="map" resultType="map">
        SELECT u.* FROM mdm_item u where u.item_category_id = #{item_category_id}
    </select>

	<select id="getAllPage" resultType="Map" parameterType="Map">
        SELECT u.*  FROM mdm_item u  where  1=1
		<if  test="item_category_id != null and item_category_id!='' ">
			and  u.item_category_id='${item_category_id}'
		</if>
		<if  test="item_description != null and item_description!='' ">
			and  u.item_description like '%${item_description}%'
		</if>
    </select>

	<select id="getAllPageByCategoryId" parameterType="map" resultType="map">
		SELECT u.*  FROM mdm_item u  where  1=1
		<if  test="item_category_id != null and item_category_id!='' ">
			and  u.item_category_id='${item_category_id}'
		</if>
	</select>

	<!-- 根据dict_id 跟 dict_out_id 删除func_dict_out 表相关信息  -->
	<delete id="deleteItemByID" parameterType="Map">
        delete from mdm_item where item_id=#{item_id}
    </delete>

	<delete id="deleteItemByCategoryID" parameterType="Map">
        delete from mdm_item where item_category_id=#{item_category_id}
    </delete>
</mapper>
